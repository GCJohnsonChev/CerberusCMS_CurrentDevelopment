<?php
/*
 ============================================================================================================
 + Cerberus Content Management System
 + ---
 + - Author 		     : Gary Christopher Johnson - Rosedale, California
 + - Electronic Mail Address : TinkeSoftware@Protonmail.com
 + - Company		     : Tinke Software
 + - Company Address	     : Rosedale, California, U.S.A.
 + - Document Notes	     : View this file in a non-formatting text editor without word-wrap for the correct
 +			       display of this programming code and its indentation.
 + ---
 +
 +
 +
 +
 +
 +
 +
 +
 +
 +
 +
 + ---
 + - File Location: root->Cerberus->Applications->Member->Login
 + - File Version : 0.6 - Wednesday, March 1st of 2023
 + ---
 + -------------------------------------------------------------------------------
 + --()()--()()()--()()()--()()()---()()()--()()()--()--()------()()()------------
 + -()-----()------()--()--()---()--()------()--()--()--()------()----------------
 + -()-----()------()--()--()---()--()------()--()--()--()------()----------------
 + -()-----()------()--()--()---()--()------()--()--()--()------()----------------
 + -()-----()()()--()()()--()()()---()()()--()()()--()--()------()----------------
 + -()-----()------()--()--()---()--()------()--()--()--()------()----------------
 + -()-----()------()--()--()---()--()------()--()--()--()------()------------/-\-
 + -()-----()------()--()--()---()--()------()--()--()--()------()------------|4|-  ~ Wynn ~
 + --()()--()()()--()--()--()()()---()()()--()--()--()()()--()()()------------\-/- Build: 0.8
 ============================================================================================================
*/

/*
 ============================================================================================================
 +
 +
 + [ ^ ] Application Module :: Member :: Login
 +
 +
 ============================================================================================================
*/

/*
 ============================================================================================================
 + Application Module Header
 ============================================================================================================
*/

											echo ($_Application_Module_Member_Message_Login_Header);
/*
 ============================================================================================================
 +
 + Application Module :: Member :: Login :: Variables
 +
 ============================================================================================================
*/

/*
 ============================================================================================================
 + Application Module :: Member :: Login :: Variables :: POST :: Authorization Form
 ============================================================================================================
*/

$_Application_Module_Member_Login_AUTHORIZATION_INTERNET_PROTOCOL_ADDRESS		= $_POST['Application_Member_Login_Authorization_IP_Address_Current'];
$_Application_Module_Member_Login_AUTHORIZATION_ELECTRONIC_MAIL_ADDRESS			= $_POST['Application_Member_Login_Authorization_IP_Address_Current'];

/*
 ============================================================================================================
 +
 + IF: Member Account Credentials Are Already Set
 +
 ============================================================================================================
*/

if ($_GLOBAL_COOKIE_MEMBER_USERNAME && $_GLOBAL_COOKIE_MEMBER_PASSWORD != null) {

											echo ($_Application_Module_Member_Message_Login_CREDENTIALS_SET);

} else {

/*
 ============================================================================================================
 +
 + Member Account Login Form
 +
 ============================================================================================================
*/

echo ("
											<FORM ACTION=\"?InternalApplication&#61;Login\" METHOD=\"post\">
													Member Electronic Mail Address:<BR>
														<INPUT TYPE=\"text\" NAME=\"post_login_electronic_mail_address\" MAXLENGTH=\"50\"><BR>
													Member Username:<BR>
														<INPUT TYPE=\"text\" NAME=\"post_login_username\" MAXLENGTH=\"50\"><BR>
													Member Password:<BR>
														<INPUT TYPE=\"password\" NAME=\"post_login_password\" MAXLENGTH=\"250\"><BR>
													<INPUT TYPE=\"submit\" VALUE=\"Login\">
												<HR>
											</FORM>

											<CENTER>[ 
<A HREF=\"$_ACCESS_URL_CLEARTEXT/$_INTERNAL_FILE_KERNAL?$_INTERNAL_APPLICATION_MODULE_MEMBER&#61;Login\" TITLE=\"Hyper-Text-Transfer-Protocol-Insecure Over Clear Text Insecure Connection\">Insecure Clear-Text Login</A>&nbsp;—&nbsp;<A HREF=\"$_ACCESS_URL_SECURE/$_INTERNAL_FILE_KERNAL?$_INTERNAL_APPLICATION_MODULE_MEMBER&#61;Login\" TITLE=\"Hyper-Text-Transfer-Protocol-Secure Over Secure Socket Layer Encrypted Connection\">SSL Secure Login</A>&nbsp;—&nbsp;<A HREF=\"$_ACCESS_URL_SECURE/Cerberus.php?$_INTERNAL_APPLICATION_MODULE_MEMBER&#61;Login\" TITLE=\"Hyper-Text-Transfer-Protocol-Secure Over Transport Layer Security Encrypted Connection\">TLS Secure Login</A>&nbsp;—&nbsp;<A HREF=\"?$_INTERNAL_APPLICATION_MODULE_MEMBER&#61;Register\" TITLE=\"Register With $_GLOBAL_SYSTEM_SITE_TITLE\">Register</A>&nbsp;—&nbsp;<A HREF=\"?$_INTERNAL_APPLICATION_MODULE_MEMBER&#61;Reset_Password\" TITLE=\"Reset Your Password Or Other Credentials\">Reset Password</A>&nbsp;—&nbsp;<A HREF=\"?$_INTERNAL_APPLICATION_MODULE_MEMBER&#61;Account_Recovery\" TITLE=\"Initiate The Member Account Recovery Options\">Account Recovery</A> ]</CENTER><BR><BR>
");

/*
 ============================================================================================================
 +
 + IF: Member Account Credentials Do Not Exist In The Database Server
 +
 ============================================================================================================
*/

if ($_GET["Message"] == "No_Member") {

											echo ($_Application_Module_Member_Message_Login_ERROR);

} // [ + ] IF: Internal Application: Display Message: No Existing Member Account Is Activated

} // [ + ] IF: Member Account Credentials Are Already Set

/*
 ============================================================================================================
 +
 + IF: Internal Application :: Internet Protocol Address Authorization
 +
 ============================================================================================================
*/

if ($_GET["Authorization"] == "IP_Address") {

if (!$_Application_Module_Member_Login_AUTHORIZATION_INTERNET_PROTOCOL_ADDRESS) {

echo ("
											Internet Protocol Authorization<HR>
											The Internet Protocol Address You Have Successfully Logged-In From Is Not Authorized<BR>
											Would you like to authorize this Internet Protocol Address ?
											<FORM ACTION=\"?InternalApplication&#61;Login&amp;Authorization&#61;IP_Address\" METHOD=\"post\">
													Current Internet Protocol Address: <A HREF=\"http://www.WhoIs.sc/$_GLOBAL_REMOTE_SERVER_ADDRESS\">$_GLOBAL_REMOTE_SERVER_ADDRESS</A><BR>
														<INPUT TYPE=\"text\" NAME=\"Application_Member_Login_Authorization_IP_Address_Current\" MAXLENGTH=\"150\" VALUE=\"$_GLOBAL_REMOTE_SERVER_ADDRESS\"><BR>
													Your Electronic Mail Address For Authorization: <A HREF=\"http://www.WhoIs.sc/$_GLOBAL_REMOTE_SERVER_ADDRESS\">$_GLOBAL_REMOTE_SERVER_ADDRESS</A><BR>
														<INPUT TYPE=\"text\" NAME=\"Application_Member_Login_Authorization_Electronic_Mail_Address\" MAXLENGTH=\"150\" VALUE=\"$_GLOBAL_REMOTE_SERVER_ADDRESS\"><BR>
													<INPUT TYPE=\"submit\" VALUE=\"Authorize\">
												<HR>
											</FORM>
");

} else {

/*
 ============================================================================================================
 +
 + Retrieve Registered Member Account Details From Database Server
 +
 ============================================================================================================
*/

$_Application_Module_Login_DB_Query_SELECT_MEMBERS					= $DB->query("SELECT * FROM {$_ACCESS_DATABASE_SERVER_DATABASE_TABLE_PREFIX}_members WHERE member_electronic_mail_address='$_Application_Module_Member_Login_AUTHORIZATION_ELECTRONIC_MAIL_ADDRESS'");

/*
 ============================================================================================================
 + IF: Submitted Electronic Mail Address Exists In Database Server
 ============================================================================================================
*/

if ($DB->num_rows($_Application_Module_Login_DB_Query_SELECT_MEMBERS)) {

/*
 ============================================================================================================
 + Retrieve List of Registered Member Account Entries From Database Server
 ============================================================================================================
*/

while ($_Application_Module_Login_DB_Query_SELECT_MEMBERS_Fetch_Array = $DB->fetch_array($_Application_Module_Login_DB_Query_SELECT_MEMBERS)) {

$_Application_Module_Login_LIST_MEMBER_ID						= $_Application_Module_Login_DB_Query_SELECT_MEMBERS_Fetch_Array['id'];
$_Application_Module_Login_LIST_MEMBER_USERNAME						= $_Application_Module_Login_DB_Query_SELECT_MEMBERS_Fetch_Array['member_username'];
$_Application_Module_Login_LIST_MEMBER_ELECTRONIC_MAIL_ADDRESS				= $_Application_Module_Login_DB_Query_SELECT_MEMBERS_Fetch_Array['member_electronic_mail_address'];

if (mail($_Application_Module_Login_LIST_MEMBER_ELECTRONIC_MAIL_ADDRESS,"Authentication Authorization Request From :: $_GLOBAL_SYSTEM_SITE_TITLE","
Dear $_Application_Module_Login_LIST_MEMBER_USERNAME :: $_Application_Module_Login_LIST_MEMBER_ELECTRONIC_MAIL_ADDRESS,
============================================================================
Either you or someone else has attempted to Login to your Member Account at: $_GLOBAL_SYSTEM_SITE_TITLE

There are three pieces of information required by default to successfully Login to any Member Account:
* UserName
* Password
* Electronic Mail Address

This Application does not display or disclose any Electronic Mail Address belonging to any Registered Member Account anywhere.
Your password is encrypted in the database using BlowFish Encryption Algorithm combined with multi-layer HASH algorithms.

If you would like to authorize this Internet Protocol Address please copy and paste the Uniform-Resource-Location Link below this message
* <A HREF=\"\"></A>

The Internet Protocol Address associated with this Login attempt was: $_GLOBAL_REMOTE_SERVER_ADDRESS
The last Internet Protocol Address on this Member Account that successfully authenticated was: $_GLOBAL_MEMBER_IP_ADDRESS_LAST_LOGIN
============================================================================
Have a nice day,
		~ $_GLOBAL_SYSTEM_SITE_TITLE

")) {

} else {

											echo ($_Application_Module_Member_Message_Login_AUTHORIZATION_ELECTRONIC_MAIL_MESSAGE_ERROR);

} // [ + ] IF: Electronic Mail Message Has Sent

} // [ + ] IF: Submitted Electronic Mail Address Exists In Database Server

} // [ + ] WHILE: Retrieving Member Account Data From Database Server

} // [ + ] IF: Authorization Form Variables Have Executed

/*
 ============================================================================================================
 + Kill Database Server Query: Check For Valid and Existing Member Account Credentials Data
 ============================================================================================================
*/

$DB->free($_Application_Module_Login_DB_Query_SELECT_MEMBERS);

} else {

											echo ($_Application_Module_Member_Message_Login_AUTHORIZATION_INTERNET_PROTOCOL_ADDRESS);

} // [ + ] IF: Internal Application: Authorization IS IP_Address
?>